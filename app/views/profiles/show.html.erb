<% flash.each do |type, message| %>
    <div class="alert alert-<%= type == 'notice' ? 'success' : 'danger' %>"><%= message %></div>
  <% end %>
  
<section class="h-100 gradient-custom-2">
  <div class="container py-5 h-100">
    <div class="row d-flex justify-content-center">
      <div class="col col-lg-9 col-xl-8">
        <div class="card">
          <div class="rounded-top text-white d-flex flex-row align-items-start" style="background-color: #000; height:200px; padding: 20px; position: relative;">
            <!-- Profile image -->
            <div class="me-4 d-flex flex-column" style="width: 150px;">
              <img src="<%= @user.profile_picture_url.presence || 'https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png' %>"
                   alt="User profile image" 
                   class="img-fluid img-thumbnail mt-4 mb-2"
                   style="width: 150px; height: 150px; object-fit: cover; z-index: 1;">
            </div>
            
            <!-- User info container for name and username -->
            <div class="ms-1" style="margin-top: 110px;">
              <h4 style="color: #fff;"><%= @user.name %></h4> 
              <h6 style="color: #ccc;">@<%= @user.username %></h6>

              <!-- Edit Profile button -->
              <% if current_user == @user %>
                <%= link_to 'Edit Profile', edit_profile_path(@user), class: 'btn btn-outline-light text-body edit-profile-button', style: 'position: absolute; bottom: 0; right: 0; margin: 10px; color: #fff;' %>
              <% end %>
            </div>
          </div>

          <!-- Bio -->
          <div class="p-4 text-black bg-body-tertiary">
            <% if @user.bio.present? %>
              <p class="mb-2" style="color: #333; font-size: 14px;"><%= @user.bio %></p>
            <% else %>
              <p class="mb-2 text-muted" style="font-size: 14px;">No bio provided.</p>
            <% end %>

             <!-- Links Section -->
            <% if @user.links.present? %>
            <div class="mt-3">
                <ul class="list-unstyled">
                <% @user.links.each do |link| %>
                    <li>
                    <a href="<%= link %>" target="_blank" rel="noopener noreferrer" style="color: #007bff; font-size: 13px;">
                        <%= link %>
                    </a>
                    </li>
                <% end %>
                </ul>
            </div>
            <% end %>

            <!-- Post count display -->
            <div class="d-flex justify-content-end text-center py-1 text-body">
              <div>
              <%#
                <p class="mb-1 h5"><%= @user.posts.count %></p> 
                <%#
                <p class="small text-muted mb-0">Posts</p> %>
              </div>
            </div>
          </div>

          <!-- Body for posts content -->
          <div class="card-body p-4 text-black">
            <div class="mb-5 text-body">
              <p class="lead fw-normal mb-0">Posts</p>

              <div class="p-4 bg-body-tertiary">
                <% if @user.posts.any? %>
                  <% @user.posts.each do |post| %>
                    <div class="mb-3">
                      <h6><%= post.title %></h6>
                      <p class="small text-muted"><%= post.created_at.strftime('%B %d, %Y') %></p>
                      <p><%= truncate(post.description, length: 100) %></p>
                      <a href="<%= post_path(post) %>" class="btn btn-link">Read More</a>
                    </div>
                  <% end %>
                <% else %>
                  <p class="text-muted">No posts to display.</p>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
